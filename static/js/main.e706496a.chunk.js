(this["webpackJsonpnim-js-game"]=this["webpackJsonpnim-js-game"]||[]).push([[0],{54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),r=n(18),s=n.n(r),a=(n(54),n(11)),o=n(7),u=n(4),l=n(5),d=(n(55),n(29)),j=(n(56),n(1)),h=function(e){var t=e.stackIdx,n=e.stackSize,c=void 0===n?{}:n,r=e.setStackSize;return Object(i.useEffect)((function(){r(Object(a.a)({},t,3))}),[]),Object(j.jsxs)("div",{className:Object(l.a)("StackSizeInputWrapper"),children:[Object(j.jsx)("input",{type:"number",id:String(t),value:(null===c||void 0===c?void 0:c[t])||3,min:1,onChange:function(e){var n=e.target.value;return r(Object(a.a)({},t,Number(n)))}}),Object(j.jsx)("label",{htmlFor:String(t),children:"Number Of elements in stack ".concat(t+1)})]})},b=(n(58),"user_move"),m="computer_move",v=function(e){var t=e.setStackAmount,n=e.setStackSize,c=e.isVisible,r=e.startGame,s=e.stackSize,a=e.stackAmount,o=e.setMove,b=Object(i.useState)(!0),v=Object(u.a)(b,2),p=v[0],f=v[1];return Object(j.jsxs)("div",{className:Object(l.a)("SettingsPopup",c&&"SettingsPopup_isVisible"),children:[Object(j.jsxs)("div",{className:"SettingsPopup-StackAmountWrapper",children:[Object(j.jsx)("input",{type:"number",id:"stackAmount",className:"SettingsPopup-StackAmount",value:a,onChange:function(e){var n=e.target.value;return t(Number(n))}}),Object(j.jsx)("label",{htmlFor:"stackAmount",children:"Number of Stacks"})]}),Object(j.jsx)("div",{className:"SettingsPopup-StackSizeWrapper",children:Object(d.a)(Array(a).keys()).map((function(e){return Object(j.jsx)(h,{stackIdx:e,stackSize:s,setStackSize:n},e)}))}),Object(j.jsxs)("div",{className:"SettingsPopup-FirstMoveWrapper",children:[Object(j.jsx)("input",{type:"checkbox",id:"firstmove",className:"SettingsPopup-FirstMove",checked:p,onChange:function(e){var t=e.target.checked;return f(t)}}),Object(j.jsx)("label",{htmlFor:"firstmove",children:"Player makes first move"})]}),Object(j.jsx)("div",{className:"SettingsPopup-StartWrapper",children:Object(j.jsx)("button",{onClick:function(){r(),p||o(m)},children:"Save & Start Game"})})]})},p=n(27),f=n(96),O=function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(p.a)(this,e),this.piles=[],this.heuristicValue=0,this.childList=[],this.getPiles=function(){return JSON.parse(JSON.stringify(n.piles))},this.getChildList=function(){return n.childList},this.getHeuristicValue=function(){return n.heuristicValue},this.setHeuristicValue=function(e){n.heuristicValue=e},this.isEmpty=function(){return n.piles.every((function(e){return 0===e}))},this.equals=function(e){return e===n||null!==e&&Object(f.a)(n.piles,e.piles)},null===i?(this.piles=t,this.childList=[]):(i.childList.push(this),this.piles=t,this.childList=[])},g=function e(t){var n=this;Object(p.a)(this,e),this.state=void 0,this.getIsEmpty=function(){return n.state.isEmpty()},this.playerMove=function(e,t){return console.log("User move"),console.log("Current state ",n.state.piles),n.state=n.move(e,t),console.log("After move ",n.state.piles),n.state.getPiles()},this.computerMove=function(){console.log("Computer move"),console.log("Current state ",n.state.piles);var e=n.minimax(n.state,3,!0),t=n.state.getChildList().find((function(t){return t.getHeuristicValue()===e}));return n.state=t||n.state.getChildList()[0],console.log("After Move ",n.state.piles),n.state.getPiles()},this.generateChildNodes=function(e){if(e.isEmpty())return[];for(var t=[],n=e.getPiles(),i=0;i<n.length;i++)for(var c=e.getPiles();c[i]>0;){c[i]=c[i]-1;var r=new O(c.map((function(e){return e})),e);t.push(r)}return t},this.minimax=function(e,t,i){if(0===t||e.isEmpty())return(i?1:-1)*n.heuristicEvaluation(e);if(i){var c=Number.MIN_SAFE_INTEGER;return n.generateChildNodes(e).forEach((function(i){var r=n.minimax(i,t-1,!1);r>c&&(c=r),i.setHeuristicValue(r),e.setHeuristicValue(c)})),c}var r=Number.MAX_SAFE_INTEGER;return n.generateChildNodes(e).forEach((function(i){var c=n.minimax(i,t-1,!0);c<r&&(r=c),i.setHeuristicValue(c),e.setHeuristicValue(r)})),r},this.heuristicEvaluation=function(e){return 0!==n.nimSum(e)?1:-1},this.nimSum=function(e){return e.getPiles().reduce((function(e,t){return e^t}),0)},this.move=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==e&&null!==t){var i=n.state.getPiles();return i[e]=i[e]-t,new O(i,n.state)}for(;;){var c=Number(prompt("choose pile")),r=n.state.getPiles();if(c<0||(null===r||void 0===r?void 0:r.length)<c)console.log("wrong pile number");else{var s=r[c],a=Number(prompt("choose amount"));if(!(a<0||0===s||s<a))return r[c]=s-a,new O(r,n.state);console.log("wrong amount")}}},this.state=t},S=(n(59),function(e){var t=e.stackSize,n=e.move,c=e.getPlayerMove,r=e.idx,s=e.coloredRed,a=Object(i.useState)(-1),o=Object(u.a)(a,2),h=o[0],m=o[1];return Object(j.jsx)("div",{className:Object(l.a)("StackWrapper"),children:Object(d.a)(Array(t).keys()).map((function(e){return Object(j.jsx)("div",{id:String(e),className:Object(l.a)("StackWrapper-Element",e<=h&&"StackWrapper-Element_isActive",e<s&&"StackWrapper-Element_isRed"),onMouseEnter:function(e){var t=e.currentTarget.id;return m(Number(t))},onMouseLeave:function(){return m(-1)},onClick:function(e){var t=e.currentTarget.id;n===b&&c(r,Number(t))},children:"\xa0"})}))})}),k=(n(60),function(e){var t=e.stacksValues,n=e.move,i=e.getPlayerMove,c=e.divRef,r=e.coloredRed;return Object(j.jsx)("div",{className:Object(l.a)("StacksWrapper"),ref:c,children:t.map((function(e,t){return Object(j.jsx)(S,{idx:t,coloredRed:(null===r||void 0===r?void 0:r[t])||-1,stackSize:e,move:n,getPlayerMove:i})}))})}),x=(n(61),function(){return Object(j.jsxs)("div",{className:"Introduction",children:[Object(j.jsx)("span",{className:"Introduction-Title",children:"Welcome to Nim Game!"}),Object(j.jsx)("span",{className:"Introduction-Instructions",children:"To start a new game click the settings button above and select game options"}),Object(j.jsx)("span",{className:"Introduction-Instructions",children:"You will be playing as Player and will have the first move (by default)"}),Object(j.jsx)("span",{className:"Introduction-Instructions",children:"To remove elements from a stack hover over the particular stack and you will see elements highlighted that you will remove and click"}),Object(j.jsx)("span",{className:"Introduction-Instructions",children:"The computers moves will be highlighted red for a split second"})]})}),N=function e(t){var n;return Object(o.a)({name:String(t.getPiles()),attributes:{heuristicVal:String(t.getHeuristicValue())}},(null===(n=t.getChildList())||void 0===n?void 0:n.length)?{children:t.getChildList().map(e)}:[])},y=n(44),E=n.n(y),w=function(e){var t=e.data,n=e.hide,c=Object(i.useRef)();return Object(j.jsxs)("div",{ref:c,id:"treeWrapper",style:{width:"100vw",height:"100vh",position:"fixed",top:0,background:"white"},children:[Object(j.jsx)("div",{children:"Tree by default is collapsed, clicking on nodes opens them up"}),Object(j.jsx)("div",{children:"You can drag the tree around"}),Object(j.jsx)("div",{children:"Tree will only appear after computer haas done the move and the tree has generated"}),Object(j.jsx)("div",{children:"Even though the tree is from last computer move, the top node is the current state"}),Object(j.jsx)("button",{onClick:n,children:"Click here to return to game"}),Object(j.jsx)(E.a,{data:t,orientation:"vertical",collapsible:!0,initialDepth:1,translate:{x:250,y:250}})]})},P=function(){var e,t,n,c=Object(i.useState)(!1),r=Object(u.a)(c,2),s=r[0],d=r[1],h=Object(i.useState)(!1),p=Object(u.a)(h,2),f=p[0],S=p[1],y=Object(i.useState)({}),E=Object(u.a)(y,2),P=E[0],A=E[1],C=Object(i.useState)(3),I=Object(u.a)(C,2),M=I[0],W=I[1],V=Object(i.useState)(b),R=Object(u.a)(V,2),T=R[0],z=R[1],L=Object(i.useState)({}),_=Object(u.a)(L,2),H=_[0],F=_[1],G=Object(i.useState)(""),B=Object(u.a)(G,2),J=B[0],Y=B[1],q=Object(i.useState)(!0),D=Object(u.a)(q,2),U=D[0],X=D[1],$=Object(i.useState)(!1),K=Object(u.a)($,2),Q=K[0],Z=K[1],ee=function(e){var t=Object(i.useRef)();return Object(i.useEffect)((function(){t.current=e})),t.current}(M)||3,te=Object(i.useRef)({}),ne=Object(i.useRef)({}),ie=Object(i.useRef)();return Object(i.useEffect)((function(){T===m&&f&&function(){var e,t=ne.current.computerMove().reduce((function(e,t,n){return Object(o.a)(Object(o.a)({},e),{},Object(a.a)({},n,t))}),{}),n=Object.fromEntries(Object.entries(P).map((function(e){var n=Object(u.a)(e,2),i=n[0];return[i,n[1]-t[i]]})));F(n),(null===(e=Object.keys(null===ne||void 0===ne?void 0:ne.current))||void 0===e?void 0:e.length)&&ne.current.getIsEmpty()?setTimeout((function(){F({}),A(t),S(!1),Y("Computer win!"),z(b)}),250):setTimeout((function(){F({}),A(t),z(b)}),250)}()}),[T]),Object(i.useEffect)((function(){if(f){var e,t,n=null===(e=ie.current)||void 0===e||null===(t=e.getBoundingClientRect())||void 0===t?void 0:t.height;n&&(ie.current.style.height="".concat(n,"px"))}}),[f]),Object(i.useEffect)((function(){M<ee&&A((function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=Object(u.a)(e,1)[0];return Number(t)<M})))}))}),[M]),Object(i.useEffect)((function(){U&&s&&X(!1)}),[s]),Object(j.jsxs)("div",{className:Object(l.a)("App",s&&"App-SettingsPopupOpen"),children:[Object(j.jsx)("button",{onClick:function(){d(!s),S(!1)},children:"Settings"}),(null===(e=ne.current)||void 0===e||null===(t=e.state)||void 0===t||null===(n=t.getPiles())||void 0===n?void 0:n.length)&&Object(j.jsx)("button",{onClick:function(){Z((function(e){return!e}))},children:"Show Tree from previous computer move"}),U&&Object(j.jsx)(x,{}),s&&Object(j.jsx)(v,{isVisible:s,startGame:function(){d(!1),S(!0),te.current=new O(Object.values(P)),ne.current=new g(te.current)},setStackAmount:W,setStackSize:function(e){A((function(t){return Object(o.a)(Object(o.a)({},t),e)}))},stackAmount:M,stackSize:P,setMove:z}),f&&Object(j.jsx)(k,{divRef:ie,stacksValues:Object.values(P),getPlayerMove:function(e,t){var n,i=ne.current.playerMove(e,t+1).reduce((function(e,t,n){return Object(o.a)(Object(o.a)({},e),{},Object(a.a)({},n,t))}),{});if((null===(n=Object.keys(null===ne||void 0===ne?void 0:ne.current))||void 0===n?void 0:n.length)&&ne.current.getIsEmpty())return S(!1),void Y("You win!");A(i),z(m)},move:T,coloredRed:H}),J&&Object(j.jsxs)("div",{className:"App-WinnerWrapper",children:[Object(j.jsx)("span",{className:"App-WhoWon",children:J}),Object(j.jsx)("button",{className:"App-PlayAgainButton",onClick:function(){Y(""),A({}),W(3),d(!0)},children:"Play Again?"})]}),Q&&Object(j.jsx)(w,{hide:function(){return Z(!1)},data:N(ne.current.state)})]})},A=n(46),C=Object(A.a)({reducer:{}}),I=n(45);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(I.a,{store:C,children:Object(j.jsx)(P,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[91,1,2]]]);
//# sourceMappingURL=main.e706496a.chunk.js.map